<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"/>
    <script src="../JS/axios.min.js"></script>
    <script src="../JS/vue.js"></script>
    <link href="../css/bootstrap.css" rel="stylesheet" />
    <script src="../JS/qs.js"></script>
    <title></title>
</head>
<body>
    <div id="app">
        <form class="el-form" >
        <p>
            <label>编号：</label>
            <label>{{userinfo.UserID}}</label>
        </p>
       <p>
             <label>姓名：</label>
         <input type="text" name="name" v-model="userinfo.UserName"/>
       </p>
       <p>
           <label>输入旧密码：</label>
           <input type="password" v-model="pwd" />
       </p>
        <p>
            <label>输入新密码：</label>
            <input type="password" v-model="rpwd" />
        </p>
            <p>
                <input type="submit" class="el-button" v-on:click="UpdatePwd(userinfo.UserID)" value="修改密码" />
            </p>
    </form>
    </div>
    
    <script>
        vms=new Vue({
            el: "#app",
            data: {
                userinfo: {},
                pwd:'',
                rpwd:'',
                geturl: "/../ashx/Personal.ashx",
                Updateurl:"/../ashx/UpdatePwd.ashx",
                form: {
                    inerstor: ''
                }
            },
                created: function () {
                    this.InitData();
                 
                },
            methods: {
                InitData: function () {
                    //ajax
                    axios.get(this.geturl).then(
                        //请求服务器成功的回调函数
                        result=>{this.userinfo = (result.data)[0]}
                        ).catch(
                       //请求服务器异常的回调函数
                        error=>{console.log(error)}
                        );
                },
                UpdatePwd:function(id){
                    alert(id)
                    axios.get(
                      this.Updateurl,
                      {
                          params:{ids:id,pwd1:vms.pwd,rpwd1:vms.rpwd}
                      }).then(
                                 function(res){if(res.data=="ok"){
                                     location.href="Login.html";
                                     
                                 }else{
                                        alert("原密码输入错误")
                                 }
                                 }
                                 ).catch(
                                     err=>{console.log(err)}
                                 );
                }
            }
        })
    </script>
</body>
</html>
